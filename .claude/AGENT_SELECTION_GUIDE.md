# üéØ Agent Selection Guide - Clear Decision Framework

## üèóÔ∏è Platform-Specific Requirements

### üî¥ Admin Portal (apps/admin/)
- **Framework**: Next.js 15 with App Router
- **UI Library**: Material-UI (MUI)
- **Styling**: Material-UI theme system (NO Tailwind)
- **API**: Next.js API routes with Clerk auth
- **Components**: React Server Components + Client Components

### üü¢ Documentation Sites (standards/*/, portal/)
- **Framework**: Docusaurus
- **UI Library**: Infima CSS framework
- **Styling**: SASS/SCSS modules (NO Material-UI)
- **Components**: MDX + React (static only)
- **NO API Routes**: Static site generation only

## üîå MCP-Powered vs Native Tool Agents

### MCP-Powered Agents (9 agents) - Use for advanced capabilities:
- **Search Agent**: JetBrains + Sequential Thinking
- **Test Writer**: Context7 + Sequential + Playwright + JetBrains
- **API Builder**: Context7 + JetBrains
- **UI Developer**: Context7 + Magic UI + JetBrains
- **Database Agent**: Supabase + Sequential + JetBrains
- **Build Agent**: NX + JetBrains + Sequential + Filesystem
- **Research Agent**: Perplexity + Context7 + Sequential + WebSearch
- **Advanced UI**: Magic UI + Context7 + Playwright
- **File Operations**: Filesystem + JetBrains + Sequential

### Native Tool Agents (5 agents) - Use for focused workflows:
- **Context Fetcher**: Optimized documentation retrieval
- **Date Checker**: System-level date determination
- **File Creator**: Template-based file creation
- **Git Workflow**: Git operations and PR management
- **Test Runner**: Test execution and failure analysis

## üìä Primary Decision Tree

```mermaid
graph TD
    Start[Task Request] --> Q1{Is it about<br/>finding/discovering?}
    
    Q1 -->|Yes| Q2{Know exact<br/>file path?}
    Q2 -->|No| SearchAgent[üîç Search Agent]
    Q2 -->|Yes| ContextFetcher[üìÑ Context Fetcher]
    
    Q1 -->|No| Q3{Is it about<br/>files/directories?}
    
    Q3 -->|Yes| Q4{Multiple files<br/>operation?}
    Q4 -->|Yes| FileOps[üìÅ File Operations Agent]
    Q4 -->|No| Q5{Creating from<br/>template?}
    Q5 -->|Yes| FileCreator[üìù File Creator Agent]
    Q5 -->|No| FileOps
    
    Q3 -->|No| Q6{Is it about<br/>UI/Frontend?}
    
    Q6 -->|Yes| Q7{Complex animations<br/>or effects?}
    Q7 -->|Yes| AdvancedUI[‚ú® Advanced UI Agent]
    Q7 -->|No| UIDevAgent[üé® UI Developer Agent]
    
    Q6 -->|No| Q8{Is it about<br/>testing?}
    
    Q8 -->|Yes| Q9{Writing or<br/>running tests?}
    Q9 -->|Writing| TestWriter[‚úçÔ∏è Test Writer Agent]
    Q9 -->|Running| TestRunner[üß™ Test Runner Agent]
    
    Q8 -->|No| Q10{Is it about<br/>data/backend?}
    
    Q10 -->|Yes| Q11{API routes or<br/>database?}
    Q11 -->|API| APIBuilder[üîß API Builder Agent]
    Q11 -->|Database| DatabaseAgent[üóÑÔ∏è Database Agent]
    
    Q10 -->|No| Q12{Is it about<br/>project/build?}
    
    Q12 -->|Yes| Q13{Git or<br/>build system?}
    Q13 -->|Git| GitWorkflow[üåø Git Workflow Agent]
    Q13 -->|Build| BuildAgent[üèóÔ∏è Build Agent]
    
    Q12 -->|No| Q14{Is it<br/>research?}
    Q14 -->|Yes| ResearchAgent[üìö Research Agent]
    Q14 -->|No| Q15{Date/time<br/>related?}
    Q15 -->|Yes| DateChecker[üìÖ Date Checker Agent]
    Q15 -->|No| MainContext[Stay in Main Context]
```

## üö¶ Priority Rules for Overlapping Scenarios

### MCP Capability Priority:
**Always prefer MCP-powered agents when available** - They provide:
- Intelligent search (JetBrains > basic grep)
- Current documentation (Context7 > outdated knowledge)
- Complex analysis (Sequential Thinking > linear steps)
- Safe database operations (Supabase MCP > raw SQL)

### When Multiple Agents Could Apply:

1. **File Operations Hierarchy**
   ```
   Priority Order:
   1. Search Agent (JetBrains MCP) - For intelligent code search and analysis
   2. File Operations (Filesystem MCP) - For batch modifications
   3. Context Fetcher (Native) - For known file content retrieval
   ```

2. **Testing Workflow**
   ```
   Priority Order:
   1. Test Runner (Native) - Execute tests and analyze failures
   2. Test Writer (MCP-powered) - Create tests with Context7 patterns + Playwright E2E
   ```

3. **UI Development**
   ```
   Admin Portal (apps/admin):
   1. UI Developer (Context7) - Material-UI components
   2. Advanced UI (Magic UI) - Enhanced MUI animations
   
   Documentation Sites (standards/*):
   1. UI Developer (Context7) - Docusaurus/Infima components
   2. Advanced UI - Rarely needed (static sites)
   ```

4. **Data Operations**
   ```
   Priority Order:
   1. Database Agent (Supabase MCP) - Direct database operations with safety checks
   2. API Builder (Context7) - Route logic with Next.js patterns
   3. Both - Use sequentially for full-stack features
   ```

5. **Documentation/Research**
   ```
   Priority Order:
   1. Research Agent (Perplexity + Context7) - Current web info + official docs
   2. Context Fetcher (Native) - Local documentation files
   3. Search Agent (JetBrains) - Finding code examples
   ```

## üéØ Clear Agent Boundaries

### File-Related Agents

| Agent | MCP Powers | PRIMARY Use | NOT For |
|-------|------------|-------------|---------|
| **Search Agent** | JetBrains + Sequential | Intelligent code search, pattern analysis | Loading full content, modifying files |
| **File Operations** | Filesystem + JetBrains | Batch modifications, directory operations | Single file edits, simple searches |
| **Context Fetcher** | Native tools | Loading known files/sections | Complex searches, modifications |
| **File Creator** | Native tools | Template-based creation | Complex logic, MCP-needed tasks |

### Development Agents

| Agent | MCP Powers | PRIMARY Use | NOT For |
|-------|------------|-------------|---------|
| **UI Developer** | Context7 + Magic UI + JetBrains | MUI (admin) or Infima (docs) components | Platform-specific UI |
| **Advanced UI** | Magic UI + Playwright | Animations, particles, effects | Simple forms, standard UI |
| **API Builder** | Context7 + JetBrains | Next.js routes (admin only) | Docusaurus sites, SQL |
| **Database Agent** | Supabase + Sequential | Safe migrations, queries | API routing logic |

### Workflow Agents

| Agent | MCP Powers | PRIMARY Use | NOT For |
|-------|------------|-------------|---------|
| **Test Writer** | Context7 + Playwright + JetBrains | Tests with library patterns, E2E | Test execution |
| **Test Runner** | Native tools | Execute and analyze tests | Writing tests |
| **Build Agent** | NX + Filesystem | Monorepo optimization | Code logic |
| **Git Workflow** | Native tools | Git operations, PRs | Code changes |
| **Research Agent** | Perplexity + Context7 | Current info + docs | Local file ops |

## üîç Common Scenarios & Agent Selection

### Scenario 1: "Find all components using useState"
```
‚úÖ Search Agent (JetBrains MCP) - Intelligent code search
‚ùå Context Fetcher - Don't know which files yet
Why MCP: JetBrains provides semantic understanding vs basic text search
```

### Scenario 2: "Update the header in all documentation files"
```
‚úÖ File Operations Agent (Filesystem MCP) - Batch modifications
‚ùå Search Agent - Not just finding, but changing
Why MCP: Filesystem MCP handles batch operations efficiently
```

### Scenario 3: "Create a new dashboard with charts in admin"
```
Step 1: ‚úÖ UI Developer (Context7) - Material-UI Grid layout
Step 2: ‚úÖ Advanced UI (Magic UI) - Animated MUI charts
Step 3: ‚úÖ Test Writer (Context7 + Playwright) - Component + E2E tests
Why MCP: Material-UI patterns for admin, NOT Docusaurus
```

### Scenario 3b: "Add interactive component to docs site"
```
Step 1: ‚úÖ UI Developer (Context7) - Docusaurus/Infima component
Step 2: ‚ùå Advanced UI - Rarely needed for static docs
Step 3: ‚úÖ Test Writer (Context7) - MDX component tests
Why: Documentation sites use Infima CSS, NOT Material-UI
```

### Scenario 4: "Fix failing tests"
```
Step 1: ‚úÖ Test Runner (Native) - Execute and parse failures
Step 2: ‚úÖ Search Agent (JetBrains MCP) - Find test implementations
Step 3: ‚úÖ Test Writer (Context7) - Fix with testing best practices
Why MCP: JetBrains finds code patterns, Context7 provides test patterns
```

### Scenario 5: "Add user authentication to API"
```
Step 1: ‚úÖ API Builder (Context7) - Next.js 15 auth (admin only!)
Step 2: ‚úÖ Database Agent (Supabase MCP) - User tables with RLS
Step 3: ‚úÖ Test Writer (Playwright) - E2E auth flow tests
Why MCP: Only apps/admin has API routes, docs sites are static
```

## ‚ö° Quick Decision Shortcuts

### By Keywords

| Keywords | Agent |
|----------|-------|
| "find", "where", "locate", "search" | Search Agent |
| "get from", "extract", "retrieve section" | Context Fetcher |
| "batch", "multiple files", "rename all" | File Operations |
| "component", "MUI", "form", "button" | UI Developer |
| "animation", "particles", "3D", "effects" | Advanced UI |
| "test", "spec", "describe", "it" | Test Writer/Runner |
| "API", "endpoint", "route", "withAuth" | API Builder |
| "query", "migration", "Supabase", "SQL" | Database Agent |
| "nx", "build", "dependencies", "monorepo" | Build Agent |
| "commit", "PR", "branch", "push" | Git Workflow |
| "research", "best practices", "compare" | Research Agent |

### By File Types

| File Pattern | Platform | Agent |
|--------------|----------|-------|
| `*.test.ts`, `*.spec.ts` | Both | Test Writer/Runner |
| `api/*/route.ts` | Admin only | API Builder |
| `*.sql`, `migrations/*` | Both | Database Agent |
| `components/*.tsx` | Admin | UI Developer (MUI) |
| `src/components/*.tsx` | Docs | UI Developer (Infima) |
| `*.mdx` | Docs only | UI Developer |
| `docusaurus.config.js` | Docs only | Build Agent |
| `nx.json`, `package.json` | Both | Build Agent |
| Multiple files | Both | File Operations |

## üö® Edge Cases & Special Rules

### Edge Case 1: "Simple" Tasks
```
Task: "Fix a typo in the README"
‚ùå WRONG: Edit directly in main context
‚úÖ RIGHT: Use Search Agent ‚Üí Context Fetcher ‚Üí Edit
Reason: Preserves context for complex work
```

### Edge Case 2: Reading Before Writing
```
Task: "Add error handling to the API"
‚úÖ ALWAYS: Search Agent first to understand current implementation
‚úÖ THEN: API Builder to implement changes
```

### Edge Case 3: Unknown Scope
```
Task: "Improve performance"
‚úÖ START: Research Agent for best practices
‚úÖ THEN: Search Agent to find bottlenecks
‚úÖ FINALLY: Appropriate specialized agent for fixes
```

### Edge Case 4: Cross-Domain Tasks
```
Task: "Add a new feature with UI and API"
‚úÖ SEQUENCE:
1. Database Agent - Schema if needed
2. API Builder - Backend logic
3. UI Developer - Frontend components
4. Test Writer - Tests for all layers
```

## üéØ Golden Rules

1. **MCP-powered agents first** - Advanced capabilities > Basic tools
2. **When in doubt, use an agent** - Context preservation > Speed
3. **Search with JetBrains** - Intelligent search > Basic grep
4. **Docs from Context7** - Current patterns > Outdated knowledge
5. **Database via Supabase MCP** - Safe operations > Raw SQL
6. **Test with Playwright** - Real browser testing > Mock tests
7. **Announce your delegation** - Always state which agent + MCP you're using

## üìù Agent Announcement Template

```
üîç "Using Search Agent with JetBrains MCP to intelligently find..."
üìÑ "Context Fetcher will load the specific section..."
üé® "UI Developer Agent with Context7 will create MUI components for admin..."
üé® "UI Developer Agent with Context7 will create Infima components for docs..."
üóÑÔ∏è "Database Agent with Supabase MCP will safely migrate..."
üß™ "Test Writer with Playwright MCP will create E2E tests..."
üìö "Research Agent with Perplexity MCP will find current best practices..."
‚úÖ "Task completed. Running final verification..."
```

## üîÑ Multi-Agent Workflows

### Full Feature Implementation (Admin Portal)
```
1. üìö Research Agent (Perplexity + Context7) ‚Üí Current best practices
2. üîç Search Agent (JetBrains) ‚Üí Analyze codebase patterns
3. üóÑÔ∏è Database Agent (Supabase MCP) ‚Üí Safe schema migrations
4. üîß API Builder (Context7) ‚Üí Next.js 15 API routes
5. üé® UI Developer (Context7) ‚Üí Material-UI components
6. ‚úçÔ∏è Test Writer (Context7 + Playwright) ‚Üí Unit + E2E tests
7. üß™ Test Runner (Native) ‚Üí Execute all tests
8. üåø Git Workflow (Native) ‚Üí Commit with conventions
```

### Documentation Site Feature
```
1. üîç Search Agent (JetBrains) ‚Üí Find similar docs components
2. üé® UI Developer (Context7) ‚Üí Docusaurus/Infima components
3. ‚úçÔ∏è Test Writer (Context7) ‚Üí MDX component tests
4. üß™ Test Runner (Native) ‚Üí Verify static generation
5. üåø Git Workflow (Native) ‚Üí Commit docs changes
Note: NO API Builder - docs sites are static only!
```

### Bug Fix Workflow
```
1. üß™ Test Runner (Native) ‚Üí Reproduce and parse failure
2. üîç Search Agent (JetBrains) ‚Üí Semantic code search
3. üìÑ Context Fetcher (Native) ‚Üí Load exact problem files
4. [MCP Agent if applicable] ‚Üí Fix with best practices
5. ‚úçÔ∏è Test Writer (Context7) ‚Üí Regression test with patterns
6. üß™ Test Runner (Native) ‚Üí Verify fix works
```

### Performance Optimization
```
1. üìö Research Agent (Perplexity) ‚Üí Latest optimization techniques
2. üèóÔ∏è Build Agent (NX MCP) ‚Üí Analyze build performance
3. üîç Search Agent (JetBrains) ‚Üí Find performance bottlenecks
4. ‚ú® Advanced UI (Magic UI) ‚Üí Optimize animations
5. üß™ Test Runner (Native) ‚Üí Performance benchmarks
```

## üîå MCP Server Decision Matrix

| Task Type | Best MCP Server | Agent to Use | Platform |
|-----------|----------------|--------------|----------|
| Find code patterns | JetBrains | Search Agent | Both |
| Get library docs | Context7 | Research/UI/API | Both |
| Complex analysis | Sequential Thinking | Any agent | Both |
| Database ops | Supabase | Database Agent | Both |
| Browser testing | Playwright | Test Writer | Both |
| Current info | Perplexity | Research Agent | Both |
| Batch files | Filesystem | File Operations | Both |
| Build analysis | NX | Build Agent | Both |
| MUI components | Context7 | UI Developer | Admin only |
| Infima/Docusaurus | Context7 | UI Developer | Docs only |
| API routes | Context7 | API Builder | Admin only |
| Animations | Magic UI | Advanced UI | Admin mainly |

---

*This guide ensures optimal agent selection for maximum context preservation and task efficiency.*